Planck_h = 6.62607015*(10^(-34));
uB = 9.274009994*10^(-24);
B = 470*10^(-6);
Delta_zs = 10^(-6)*2*uB*B/Planck_h;
Delta_zd = 10^(-6)*(4/5)*uB*B/Planck_h;
Delta_zp = 10^(-6)*(2/3)*uB*B/Planck_h;
pol_minus_s = sqrt(1/3); pol_0_s = sqrt(1/3); pol_plus_s = sqrt(1/3);
pol_minus_d = sqrt(1/3); pol_0_d = sqrt(1/3); pol_plus_d = sqrt(1/3);

gamma_S = 95.3; %Decay rate of P_1/2 state to S_1/2 in MHz
gamma_D = 31; %Decay rate of P_1/2 state to D_3/2 in MHz
Omega_S = 0.3*899.4180;
%Omega_S2 = 0.3*899.4180;
%Omega_D0 = 0.3*1.4169e+03;
Omega_D = 0.3*1.4169e+03;
%Omega_D2 = 0.3*1.4169e+03;
%Omega_D3 = 0.3*1.4169e+03;
%Delta_S1 = -2*pi*20;
%Delta_S2 = -2*pi*40;
%Delta_D0 = -2*pi*200;
%Delta_D1 = -2*pi*200;
%Delta_D2 = -2*pi*200;
%Delta_D3 = -2*pi*200;

deltat = 0.0000001;
t_end = 1;

t=0:deltat:t_end;
sigma_S0S0 = zeros(1,64); S0S0=1;
sigma_S1S1 = zeros(1,64); S1S1=2;
sigma_D0D0 = zeros(1,64); D0D0=3;
sigma_D1D1 = zeros(1,64); D1D1=4;
sigma_D2D2 = zeros(1,64); D2D2=5;
sigma_D3D3 = zeros(1,64); D3D3=6;
sigma_P0P0 = zeros(1,64); P0P0=7;
sigma_P1P1 = zeros(1,64); P1P1=8;
sigma_S0S1 = zeros(1,64); S0S1=9;
sigma_S0D0 = zeros(1,64); S0D0=10;
sigma_S0D1 = zeros(1,64); S0D1=11;
sigma_S0D2 = zeros(1,64); S0D2=12;
sigma_S0D3 = zeros(1,64); S0D3=13;
sigma_S0P0 = zeros(1,64); S0P0=14;
sigma_S0P1 = zeros(1,64); S0P1=15;
sigma_S1D0 = zeros(1,64); S1D0=16;
sigma_S1D1 = zeros(1,64); S1D1=17;
sigma_S1D2 = zeros(1,64); S1D2=18;
sigma_S1D3 = zeros(1,64); S1D3=19;
sigma_S1P0 = zeros(1,64); S1P0=20;
sigma_S1P1 = zeros(1,64); S1P1=21;
sigma_D0D1 = zeros(1,64); D0D1=22;
sigma_D0D2 = zeros(1,64); D0D2=23;
sigma_D0D3 = zeros(1,64); D0D3=24;
sigma_D0P0 = zeros(1,64); D0P0=25;
sigma_D0P1 = zeros(1,64); D0P1=26;
sigma_D1D2 = zeros(1,64); D1D2=27;
sigma_D1D3 = zeros(1,64); D1D3=28;
sigma_D1P0 = zeros(1,64); D1P0=29;
sigma_D1P1 = zeros(1,64); D1P1=30;
sigma_D2D3 = zeros(1,64); D2D3=31;
sigma_D2P0 = zeros(1,64); D2P0=32;
sigma_D2P1 = zeros(1,64); D2P1=33;
sigma_D3P0 = zeros(1,64); D3P0=34;
sigma_D3P1 = zeros(1,64); D3P1=35;
sigma_P0P1 = zeros(1,64); P0P1=36;
sigma_S1S0 = zeros(1,64); S1S0=37;
sigma_D0S0 = zeros(1,64); D0S0=38;
sigma_D1S0 = zeros(1,64); D1S0=39;
sigma_D2S0 = zeros(1,64); D2S0=40;
sigma_D3S0 = zeros(1,64); D3S0=41;
sigma_P0S0 = zeros(1,64); P0S0=42;
sigma_P1S0 = zeros(1,64); P1S0=43;
sigma_D0S1 = zeros(1,64); D0S1=44;
sigma_D1S1 = zeros(1,64); D1S1=45;
sigma_D2S1 = zeros(1,64); D2S1=46;
sigma_D3S1 = zeros(1,64); D3S1=47;
sigma_P0S1 = zeros(1,64); P0S1=48;
sigma_P1S1 = zeros(1,64); P1S1=49;
sigma_D1D0 = zeros(1,64); D1D0=50;
sigma_D2D0 = zeros(1,64); D2D0=51;
sigma_D3D0 = zeros(1,64); D3D0=52;
sigma_P0D0 = zeros(1,64); P0D0=53;
sigma_P1D0 = zeros(1,64); P1D0=54;
sigma_D2D1 = zeros(1,64); D2D1=55;
sigma_D3D1 = zeros(1,64); D3D1=56;
sigma_P0D1 = zeros(1,64); P0D1=57;
sigma_P1D1 = zeros(1,64); P1D1=58;
sigma_D3D2 = zeros(1,64); D3D2=59;
sigma_P0D2 = zeros(1,64); P0D2=60;
sigma_P1D2 = zeros(1,64); P1D2=61;
sigma_P0D3 = zeros(1,64); P0D3=62;
sigma_P1D3 = zeros(1,64); P1D3=63;
sigma_P1P0 = zeros(1,64); P1P0=64;

sigma_S0S0(S0S0) = 1;
sigma_S1S1(S1S1) = 1;
sigma_D0D0(D0D0) = 1;
sigma_D1D1(D1D1) = 1;
sigma_D2D2(D2D2) = 1;
sigma_D3D3(D3D3) = 1;
sigma_P0P0(P0P0) = 1;
sigma_P1P1(P1P1) = 1;
sigma_S0S1(S0S1) = 1;
sigma_S0D0(S0D0) = 1;
sigma_S0D1(S0D1) = 1;
sigma_S0D2(S0D2) = 1;
sigma_S0D3(S0D3) = 1;
sigma_S0P0(S0P0) = 1;
sigma_S0P1(S0P1) = 1;
sigma_S1D0(S1D0) = 1;
sigma_S1D1(S1D1) = 1;
sigma_S1D2(S1D2) = 1;
sigma_S1D3(S1D3) = 1;
sigma_S1P0(S1P0) = 1;
sigma_S1P1(S1P1) = 1;
sigma_D0D1(D0D1) = 1;
sigma_D0D2(D0D2) = 1;
sigma_D0D3(D0D3) = 1;
sigma_D0P0(D0P0) = 1;
sigma_D0P1(D0P1) = 1;
sigma_D1D2(D1D2) = 1;
sigma_D1D3(D1D3) = 1;
sigma_D1P0(D1P0) = 1;
sigma_D1P1(D1P1) = 1;
sigma_D2D3(D2D3) = 1;
sigma_D2P0(D2P0) = 1;
sigma_D2P1(D2P1) = 1;
sigma_D3P0(D3P0) = 1;
sigma_D3P1(D3P1) = 1;
sigma_P0P1(P0P1) = 1;
sigma_S1S0(S1S0) = 1;
sigma_D0S0(D0S0) = 1;
sigma_D1S0(D1S0) = 1;
sigma_D2S0(D2S0) = 1;
sigma_D3S0(D3S0) = 1;
sigma_P0S0(P0S0) = 1;
sigma_P1S0(P1S0) = 1;
sigma_D0S1(D0S1) = 1;
sigma_D1S1(D1S1) = 1;
sigma_D2S1(D2S1) = 1;
sigma_D3S1(D3S1) = 1;
sigma_P0S1(P0S1) = 1;
sigma_P1S1(P1S1) = 1;
sigma_D1D0(D1D0) = 1;
sigma_D2D0(D2D0) = 1;
sigma_D3D0(D3D0) = 1;
sigma_P0D0(P0D0) = 1;
sigma_P1D0(P1D0) = 1;
sigma_D2D1(D2D1) = 1;
sigma_D3D1(D3D1) = 1;
sigma_P0D1(P0D1) = 1;
sigma_P1D1(P1D1) = 1;
sigma_D3D2(D3D2) = 1;
sigma_P0D2(P0D2) = 1;
sigma_P1D2(P1D2) = 1;
sigma_P0D3(P0D3) = 1;
sigma_P1D3(P1D3) = 1;
sigma_P1P0(P1P0) = 1;

sigma_t = nan(numel(sigma_S1S1),numel(t));
sigma_t(:,1) = 0;
sigma_t(1,1) = 1;

Evol_Matrix = nan(numel(sigma_S0S0),numel(sigma_S0S0));

Evol_Matrix(S0S0,:) = (1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*(sigma_S0P0-sigma_P0S0)...
    + sqrt(2/3).*pol_plus_s.*(sigma_S0P1-sigma_P1S0))...
    +(1/3)*gamma_S.*sigma_P0P0 + (2/3)*gamma_S.*sigma_P1P1);

Evol_Matrix(S1S1,:) = (1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*(sigma_S1P0-sigma_P0S1)...
    + sqrt(1/3).*pol_0_s.*(sigma_S1P1 - sigma_P1S1))...
    +(2/3)*gamma_S.*sigma_P0P0 + (1/3)*gamma_S.*sigma_P1P1);

Evol_Matrix(D0D0,:) = (1i.*(Omega_D/2).*pol_plus_d.*(sigma_D0P0-sigma_P0D0)...
    +(1/2).*gamma_D.*sigma_P0P0);

Evol_Matrix(D1D1,:) = (1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*(sigma_D1P0-sigma_P0D1)...
    + sqrt(1/3).*pol_plus_d.*(sigma_D1P1 - sigma_P1D1))...
    +(1/3)*gamma_D.*sigma_P0P0 + (1/6)*gamma_D.*sigma_P1P1);

Evol_Matrix(D2D2,:) = (1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*(sigma_D2P0-sigma_P0D2)...
    + sqrt(2/3).*pol_0_d.*(sigma_D2P1 - sigma_P1D2))...
    +(1/6)*gamma_D.*sigma_P0P0 + (1/3)*gamma_D.*sigma_P1P1);

Evol_Matrix(D3D3,:) = (1i.*(Omega_D/2).*pol_minus_d.*(sigma_D3P1-sigma_P1D3)...
    +(1/2).*gamma_D.*sigma_P1P1);

Evol_Matrix(P0P0,:) = (1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*(sigma_P0S0-sigma_S0P0)...
    + sqrt(2/3).*pol_minus_s.*(sigma_P0S1 - sigma_S1P0))...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sigma_P0D0-sigma_D0P0)...
    + sqrt(2/3).*pol_0_d.*(sigma_P0D1 - sigma_D1P0)...
    + sqrt(1/3).*pol_minus_d.*(sigma_P0D2 - sigma_D2P0))...
    -(gamma_S + gamma_D).*sigma_P0P0);

Evol_Matrix(P1P1,:) = (1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*(sigma_P1S0-sigma_S0P1)...
    + sqrt(1/3).*pol_0_s.*(sigma_P1S1 - sigma_S1P1))...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*(sigma_P1D1-sigma_D1P1)...
    + sqrt(2/3).*pol_0_d.*(sigma_P1D2 - sigma_D2P1)...
    + pol_minus_d.*(sigma_P1D3 - sigma_D3P1))...
    -(gamma_S + gamma_D).*sigma_P1P1);

Evol_Matrix(S0S1,:) = (1i.*Delta_zs.*sigma_S0S1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_S0P0...
    + sqrt(1/3).*pol_0_s.*(sigma_S0P1 - sigma_P0S1)...
    + sqrt(2/3).*pol_plus_s.*sigma_P1S1));

Evol_Matrix(S0D0,:) = (1i.*(Delta_DP01 - Delta_SP01).*sigma_S0D0...
    +1i.*(Omega_D/2).*pol_plus_d.*sigma_S0P0...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_P0D0 + sqrt(2/3).*pol_plus_s.*sigma_P1D0));

Evol_Matrix(S0D1,:) = (1i.*(Delta_DP01 + Delta_zd - Delta_SP01).*sigma_S0D1...
    +1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*sigma_S0P0 + sqrt(1/3).*pol_plus_d.*sigma_S0P1)...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_P0D1 + sqrt(2/3).*pol_plus_s.*sigma_P1D1));

Evol_Matrix(S0D2,:) = (1i.*(Delta_DP01 + 2.*Delta_zd - Delta_SP01).*sigma_S0D2...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_S0P0 + sqrt(2/3).*pol_0_d.*sigma_S0P1)...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_P0D2 + sqrt(2/3).*pol_plus_s.*sigma_P1D2));

Evol_Matrix(S0D3,:) = (1i.*(Delta_DP01 + 3.*Delta_zd - Delta_SP01).*sigma_S0D3...
    +1i.*(Omega_D/2).*pol_minus_d.*sigma_S0P1...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_P0D3 + sqrt(2/3).*pol_plus_s.*sigma_P1D3));

Evol_Matrix(S0P0,:) = (-1i.*(Delta_SP01 + Delta_zp).*sigma_S0P0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*(sigma_S0S0 - sigma_P0P0)...
    + sqrt(2/3).*pol_minus_s.*sigma_S0S1...
    - sqrt(2/3).*pol_plus_s.*sigma_P1P0)...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_S0D0...
    + sqrt(2/3).*pol_0_d.*sigma_S0D1...
    + sqrt(1/3).*pol_minus_d.*sigma_S0D2)...
    -((gamma_S+gamma_D)./2).*sigma_S0P0);

Evol_Matrix(S0P1,:) = (-1i.*Delta_SP01.*sigma_S0P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*(sigma_S0S0 - sigma_P1P1)...
    + sqrt(1/3).*pol_0_s.*(sigma_S0S1 - sigma_P0P1))...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_S0D1...
    + sqrt(2/3).*pol_0_d.*sigma_S0D2...
    + pol_minus_d.*sigma_S0D3)...
    -((gamma_S+gamma_D)./2).*sigma_S0P1);

Evol_Matrix(S1D0,:) = (1i.*(Delta_DP01 - Delta_SP01 - Delta_zs).*sigma_S1D0...
    +1i.*(Omega_D/2).*pol_plus_d.*sigma_S1P0...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_P0D0 + sqrt(1/3).*pol_0_s.*sigma_P1D0));

Evol_Matrix(S1D1,:) = (1i.*(Delta_DP01 + Delta_zd - Delta_SP01 - Delta_zs).*sigma_S1D1...
    +1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*sigma_S1P0 + sqrt(1/3).*pol_plus_d.*sigma_S1P1)...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_P0D1 + sqrt(1/3).*pol_0_s.*sigma_P1D1));

Evol_Matrix(S1D2,:) = (1i.*(Delta_DP01 + 2.*Delta_zd - Delta_SP01 - Delta_zs).*sigma_S1D2...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_S1P0 + sqrt(2/3).*pol_0_d.*sigma_S1P1)...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_P0D2 + sqrt(1/3).*pol_0_s.*sigma_P1D2));

Evol_Matrix(S1D3,:) = (1i.*(Delta_DP01 + 3.*Delta_zd - Delta_SP01 - Delta_zs).*sigma_S1D3...
    +1i.*(Omega_D/2).*pol_minus_d.*sigma_S1P1...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_P0D3 + sqrt(1/3).*pol_0_s.*sigma_P1D3));

Evol_Matrix(S1P0,:) = (-1i.*(Delta_SP01 + Delta_zp + Delta_zs).*sigma_S1P0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*(sigma_S1S0 - sigma_P1P0)...
    + sqrt(2/3).*pol_minus_s.*(sigma_S1S1 - sigma_P0P0))...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_S1D0...
    + sqrt(2/3).*pol_0_d.*sigma_S1D1...
    + sqrt(1/3).*pol_minus_d.*sigma_S1D2)...
    -((gamma_S+gamma_D)./2).*sigma_S1P0);

Evol_Matrix(S1P1,:) = (-1i.*(Delta_SP01 + Delta_zs).*sigma_S1P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S1S0...
    + sqrt(1/3).*pol_0_s.*(sigma_S1S1 - sigma_P1P1)...
    - sqrt(2/3).*pol_minus_s.*sigma_P0P1)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_S1D1...
    + sqrt(2/3).*pol_0_d.*sigma_S1D2...
    + pol_minus_d.*sigma_S1D3)...
    -((gamma_S+gamma_D)./2).*sigma_S1P1);

Evol_Matrix(D0D1,:) = (1i.*Delta_zd.*sigma_D0D1...
    +1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*sigma_D0P0...
    + sqrt(1/3).*pol_plus_d.*sigma_D0P1...
    - pol_plus_d.*sigma_P0D1));

Evol_Matrix(D0D2,:) = (1i.*2.*Delta_zd.*sigma_D0D2...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_D0P0...
    + sqrt(2/3).*pol_0_d.*sigma_D0P1...
    - pol_plus_d.*sigma_P0D2));

Evol_Matrix(D0D3,:) = (1i.*3.*Delta_zd.*sigma_D0D3...
    +1i.*(Omega_D/2).*(pol_minus_d.*sigma_D0P1...
    - pol_plus_d.*sigma_P0D3));

Evol_Matrix(D0P0,:) = (-1i.*(Delta_zp + Delta_DP01).*sigma_D0P0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D0S0...
    + sqrt(2/3).*pol_minus_s.*sigma_D0S1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sigma_D0D0 - sigma_P0P0)...
    + sqrt(2/3).*pol_0_d.*sigma_D0D1...
    + sqrt(1/3).*pol_minus_d.*sigma_D0D2)...
    -((gamma_S+gamma_D)./2).*sigma_D0P0);

Evol_Matrix(D0P1,:) = (-1i.*Delta_DP01.*sigma_D0P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_D0S0...
    + sqrt(1/3).*pol_0_s.*sigma_D0S1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sqrt(1/3).*sigma_D0D1 - pol_plus_d.*sigma_P0P1)...
    + sqrt(2/3).*pol_0_d.*sigma_D0D2...
    + pol_minus_d.*sigma_D0D3)...
    -((gamma_S+gamma_D)./2).*sigma_D0P1);

Evol_Matrix(D1D2,:) = (1i.*Delta_zd.*sigma_D1D2...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_D1P0...
    + sqrt(2/3).*pol_0_d.*(sigma_D1P1 - sigma_P0D2)...
    - sqrt(1/3).*pol_plus_d.*sigma_P1D2));

Evol_Matrix(D1D3,:) = (1i.*2.*Delta_zd.*sigma_D1D3...
    +1i.*(Omega_D/2).*(pol_minus_d.*sigma_D1P1...
    - sqrt(2/3).*pol_0_d.*sigma_P0D3...
    - sqrt(1/3).*pol_plus_d.*sigma_P1D3));

Evol_Matrix(D1P0,:) = (-1i.*(Delta_zp + Delta_DP01 + Delta_zd).*sigma_D1P0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D1S0...
    + sqrt(2/3).*pol_minus_s.*sigma_D1S1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sigma_D1D0 - sqrt(1/3).*sigma_P1P0)...
    + sqrt(2/3).*pol_0_d.*(sigma_D1D1 - sigma_P0P0)...
    + sqrt(1/3).*pol_minus_d.*sigma_D1D2)...
    -((gamma_S+gamma_D)./2).*sigma_D1P0);

Evol_Matrix(D1P1,:) = (-1i.*(Delta_DP01 + Delta_zd).*sigma_D1P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_D1S0...
    + sqrt(1/3).*pol_0_s.*sigma_D1S1)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*(sigma_D1D1 - sigma_P1P1)...
    + sqrt(2/3).*pol_0_d.*(sigma_D1D2 - sigma_P0P1)...
    + pol_minus_d.*sigma_D1D3)...
    -((gamma_S+gamma_D)./2).*sigma_D1P1);

Evol_Matrix(D2D3,:) = (1i.*Delta_zd.*sigma_D2D3...
    +1i.*(Omega_D/2).*(pol_minus_d.*(sigma_D2P1 - sqrt(1/3).*sigma_P0D3)...
    - sqrt(2/3).*pol_0_d.*sigma_P1D3));

Evol_Matrix(D2P0,:) = (-1i.*(Delta_zp + Delta_DP01 + 2.*Delta_zd).*sigma_D2P0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D2S0...
    + sqrt(2/3).*pol_minus_s.*sigma_D2S1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_D2D0...
    + sqrt(2/3).*pol_0_d.*(sigma_D2D1 - sigma_P1P0)...
    + sqrt(1/3).*pol_minus_d.*(sigma_D2D2 - sigma_P0P0))...
    -((gamma_S+gamma_D)./2).*sigma_D2P0);

Evol_Matrix(D2P1,:) = (-1i.*(Delta_DP01 + 2.*Delta_zd).*sigma_D2P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_D2S0...
    + sqrt(1/3).*pol_0_s.*sigma_D2S1)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_D2D1...
    + sqrt(2/3).*pol_0_d.*(sigma_D2D2 - sigma_P1P1)...
    + pol_minus_d.*(sigma_D2D3 - sqrt(1/3).*sigma_P0P1))...
    -((gamma_S+gamma_D)./2).*sigma_D2P1);

Evol_Matrix(D3P0,:) = (-1i.*(Delta_zp + Delta_DP01 + 3.*Delta_zd).*sigma_D3P0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D3S0...
    + sqrt(2/3).*pol_minus_s.*sigma_D3S1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_D3D0...
    + sqrt(2/3).*pol_0_d.*sigma_D3D1...
    + pol_minus_d.*(sqrt(1/3).*sigma_D3D2 - sigma_P1P0))...
    -((gamma_S+gamma_D)./2).*sigma_D3P0);

Evol_Matrix(D3P1,:) = (-1i.*(Delta_DP01 + 3.*Delta_zd).*sigma_D3P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_D3S0...
    + sqrt(1/3).*pol_0_s.*sigma_D3S1)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_D3D1...
    + sqrt(2/3).*pol_0_d.*sigma_D3D2...
    + pol_minus_d.*(sigma_D3D3 - sigma_P1P1))...
    -((gamma_S+gamma_D)./2).*sigma_D3P1);

Evol_Matrix(P0P1,:) = (1i.*Delta_zp.*sigma_P0P1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_P0S0...
    + sqrt(1/3).*pol_0_s.*(sigma_P0S1 - sigma_S0P1)...
    - sqrt(2/3).*pol_minus_s.*sigma_S1P1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sqrt(1/3).*sigma_P0D1 - sigma_D0P1)...
    + sqrt(2/3).*pol_0_d.*(sigma_P0D2 - sigma_D1P1)...
    + pol_minus_d.*(sigma_P0D3 - sqrt(1/3).*sigma_D2P1))...
    -(gamma_S + gamma_D).*sigma_P0P1);

Evol_Matrix(S1S0,:) = conj(1i.*Delta_zs.*sigma_S1S0...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_P0S0...
    + sqrt(1/3).*pol_0_s.*(sigma_P1S0 - sigma_S1P0)...
    + sqrt(2/3).*pol_plus_s.*sigma_S1P1));

Evol_Matrix(D0S0,:) = conj(1i.*(Delta_DP01 - Delta_SP01).*sigma_D0S0...
    +1i.*(Omega_D/2).*pol_plus_d.*sigma_P0S0...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D0P0 + sqrt(2/3).*pol_plus_s.*sigma_D0P1));

Evol_Matrix(D1S0,:) = conj(1i.*(Delta_DP01 + Delta_zd - Delta_SP01).*sigma_D1S0...
    +1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*sigma_P0S0 + sqrt(1/3).*pol_plus_d.*sigma_P1S0)...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D1P0 + sqrt(2/3).*pol_plus_s.*sigma_D1P1));

Evol_Matrix(D2S0,:) = conj(1i.*(Delta_DP01 + 2.*Delta_zd - Delta_SP01).*sigma_D2S0...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_P0S0 + sqrt(2/3).*pol_0_d.*sigma_P1S0)...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D2P0 + sqrt(2/3).*pol_plus_s.*sigma_D2P1));

Evol_Matrix(D3S0,:) = conj(1i.*(Delta_DP01 + 3.*Delta_zd - Delta_SP01).*sigma_D3S0...
    +1i.*(Omega_D/2).*pol_minus_d.*sigma_P1S0...
    -1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_D3P0 + sqrt(2/3).*pol_plus_s.*sigma_D3P1));

Evol_Matrix(P0S0,:) = conj(-1i.*(Delta_SP01 + Delta_zp).*sigma_P0S0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*(sigma_S0S0 - sigma_P0P0)...
    + sqrt(2/3).*pol_minus_s.*sigma_S1S0...
    - sqrt(2/3).*pol_plus_s.*sigma_P0P1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_D0S0...
    + sqrt(2/3).*pol_0_d.*sigma_D1S0...
    + sqrt(1/3).*pol_minus_d.*sigma_D2S0)...
    -((gamma_S+gamma_D)./2).*sigma_P0S0);

Evol_Matrix(P1S0,:) = conj(-1i.*Delta_SP01.*sigma_P1S0...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*(sigma_S0S0 - sigma_P1P1)...
    + sqrt(1/3).*pol_0_s.*(sigma_S1S0 - sigma_P1P0))...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_D1S0...
    + sqrt(2/3).*pol_0_d.*sigma_D2S0...
    + pol_minus_d.*sigma_D3S0)...
    -((gamma_S+gamma_D)./2).*sigma_P1S0);

Evol_Matrix(D0S1,:) = conj(1i.*(Delta_DP01 - Delta_SP01 - Delta_zs).*sigma_D0S1...
    +1i.*(Omega_D/2).*pol_plus_d.*sigma_P0S1...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_D0P0 + sqrt(1/3).*pol_0_s.*sigma_D0P1));

Evol_Matrix(D1S1,:) = conj(1i.*(Delta_DP01 + Delta_zd - Delta_SP01 - Delta_zs).*sigma_D1S1...
    +1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*sigma_P0S1 + sqrt(1/3).*pol_plus_d.*sigma_P1S1)...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_D1P0 + sqrt(1/3).*pol_0_s.*sigma_D1P1));

Evol_Matrix(D2S1,:) = conj(1i.*(Delta_DP01 + 2.*Delta_zd - Delta_SP01 - Delta_zs).*sigma_D2S1...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_P0S1 + sqrt(2/3).*pol_0_d.*sigma_P1S1)...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_D2P0 + sqrt(1/3).*pol_0_s.*sigma_D2P1));

Evol_Matrix(D3S1,:) = conj(1i.*(Delta_DP01 + 3.*Delta_zd - Delta_SP01 - Delta_zs).*sigma_D3S1...
    +1i.*(Omega_D/2).*pol_minus_d.*sigma_P1S1...
    -1i.*(Omega_S/2).*(sqrt(2/3).*pol_minus_s.*sigma_D3P0 + sqrt(1/3).*pol_0_s.*sigma_D3P1));

Evol_Matrix(P0S1,:) = conj(-1i.*(Delta_SP01 + Delta_zp + Delta_zs).*sigma_P0S1...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*(sigma_S0S1 - sigma_P0P1)...
    + sqrt(2/3).*pol_minus_s.*(sigma_S1S1 - sigma_P0P0))...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_D0S1...
    + sqrt(2/3).*pol_0_d.*sigma_D1S1...
    + sqrt(1/3).*pol_minus_d.*sigma_D2S1)...
    -((gamma_S+gamma_D)./2).*sigma_P0S1);

Evol_Matrix(P1S1,:) = conj(-1i.*(Delta_SP01 + Delta_zs).*sigma_P1S1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S0S1...
    + sqrt(1/3).*pol_0_s.*(sigma_S1S1 - sigma_P1P1)...
    - sqrt(2/3).*pol_minus_s.*sigma_P1P0)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_D1S1...
    + sqrt(2/3).*pol_0_d.*sigma_D2S1...
    + pol_minus_d.*sigma_D3S1)...
    -((gamma_S+gamma_D)./2).*sigma_P1S1);

Evol_Matrix(D1D0,:) = conj(1i.*Delta_zd.*sigma_D1D0...
    +1i.*(Omega_D/2).*(sqrt(2/3).*pol_0_d.*sigma_P0D0...
    + sqrt(1/3).*pol_plus_d.*sigma_P1D0...
    - pol_plus_d.*sigma_D1P0));

Evol_Matrix(D2D0,:) = conj(1i.*2.*Delta_zd.*sigma_D2D0...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_P0D0...
    + sqrt(2/3).*pol_0_d.*sigma_P1D0...
    - pol_plus_d.*sigma_D2P0));

Evol_Matrix(D3D0,:) = conj(1i.*3.*Delta_zd.*sigma_D3D0...
    +1i.*(Omega_D/2).*(pol_minus_d.*sigma_P1D0...
    - pol_plus_d.*sigma_D3P0));

Evol_Matrix(P0D0,:) = conj(-1i.*(Delta_zp + Delta_DP01).*sigma_P0D0...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_S0D0...
    + sqrt(2/3).*pol_minus_s.*sigma_S1D0)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sigma_D0D0 - sigma_P0P0)...
    + sqrt(2/3).*pol_0_d.*sigma_D1D0...
    + sqrt(1/3).*pol_minus_d.*sigma_D2D0)...
    -((gamma_S+gamma_D)./2).*sigma_P0D0);

Evol_Matrix(P1D0,:) = conj(-1i.*Delta_DP01.*sigma_P1D0...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S0D0...
    + sqrt(1/3).*pol_0_s.*sigma_S1D0)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sqrt(1/3).*sigma_D1D0 - pol_plus_d.*sigma_P1P0)...
    + sqrt(2/3).*pol_0_d.*sigma_D2D0...
    + pol_minus_d.*sigma_D3D0)...
    -((gamma_S+gamma_D)./2).*sigma_P1D0);

Evol_Matrix(D2D1,:) = conj(1i.*Delta_zd.*sigma_D2D1...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_minus_d.*sigma_P0D1...
    + sqrt(2/3).*pol_0_d.*(sigma_P1D1 - sigma_D2P0)...
    - sqrt(1/3).*pol_plus_d.*sigma_D2P1));

Evol_Matrix(D3D1,:) = conj(1i.*2.*Delta_zd.*sigma_D3D1...
    +1i.*(Omega_D/2).*(pol_minus_d.*sigma_P1D1...
    - sqrt(2/3).*pol_0_d.*sigma_D3P0...
    - sqrt(1/3).*pol_plus_d.*sigma_D3P1));

Evol_Matrix(P0D1,:) = conj(-1i.*(Delta_zp + Delta_DP01 + Delta_zd).*sigma_P0D1...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_S0D1...
    + sqrt(2/3).*pol_minus_s.*sigma_S1D1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sigma_D0D1 - sqrt(1/3).*sigma_P0P1)...
    + sqrt(2/3).*pol_0_d.*(sigma_D1D1 - sigma_P0P0)...
    + sqrt(1/3).*pol_minus_d.*sigma_D2D1)...
    -((gamma_S+gamma_D)./2).*sigma_P0D1);

Evol_Matrix(P1D1,:) = conj(-1i.*(Delta_DP01 + Delta_zd).*sigma_P1D1...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S0D1...
    + sqrt(1/3).*pol_0_s.*sigma_S1D1)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*(sigma_D1D1 - sigma_P1P1)...
    + sqrt(2/3).*pol_0_d.*(sigma_D2D1 - sigma_P1P0)...
    + pol_minus_d.*sigma_D3D1)...
    -((gamma_S+gamma_D)./2).*sigma_P1D1);

Evol_Matrix(D3D2,:) = conj(1i.*Delta_zd.*sigma_D3D2...
    +1i.*(Omega_D/2).*(pol_minus_d.*(sigma_P1D2 - sqrt(1/3).*sigma_D3P0)...
    - sqrt(2/3).*pol_0_d.*sigma_D3P1));

Evol_Matrix(P0D2,:) = conj(-1i.*(Delta_zp + Delta_DP01 + 2.*Delta_zd).*sigma_P0D2...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_S0D2...
    + sqrt(2/3).*pol_minus_s.*sigma_S1D2)...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_D0D2...
    + sqrt(2/3).*pol_0_d.*(sigma_D1D2 - sigma_P0P1)...
    + sqrt(1/3).*pol_minus_d.*(sigma_D2D2 - sigma_P0P0))...
    -((gamma_S+gamma_D)./2).*sigma_P0D2);

Evol_Matrix(P1D2,:) = conj(-1i.*(Delta_DP01 + 2.*Delta_zd).*sigma_P1D2...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S0D2...
    + sqrt(1/3).*pol_0_s.*sigma_S1D2)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_D1D2...
    + sqrt(2/3).*pol_0_d.*(sigma_D2D2 - sigma_P1P1)...
    + pol_minus_d.*(sigma_D3D2 - sqrt(1/3).*sigma_P1P0))...
    -((gamma_S+gamma_D)./2).*sigma_P1D2);

Evol_Matrix(P0D3,:) = conj(-1i.*(Delta_zp + Delta_DP01 + 3.*Delta_zd).*sigma_P0D3...
    +1i.*(Omega_S/2).*(sqrt(1/3).*pol_0_s.*sigma_S0D3...
    + sqrt(2/3).*pol_minus_s.*sigma_S1D3)...
    +1i.*(Omega_D/2).*(pol_plus_d.*sigma_D0D3...
    + sqrt(2/3).*pol_0_d.*sigma_D1D3...
    + pol_minus_d.*(sqrt(1/3).*sigma_D2D3 - sigma_P0P1))...
    -((gamma_S+gamma_D)./2).*sigma_P0D3);

Evol_Matrix(P1D3,:) = conj(-1i.*(Delta_DP01 + 3.*Delta_zd).*sigma_P1D3...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S0D3...
    + sqrt(1/3).*pol_0_s.*sigma_S1D3)...
    +1i.*(Omega_D/2).*(sqrt(1/3).*pol_plus_d.*sigma_D1D3...
    + sqrt(2/3).*pol_0_d.*sigma_D2D3...
    + pol_minus_d.*(sigma_D3D3 - sigma_P1P1))...
    -((gamma_S+gamma_D)./2).*sigma_P1D3);

Evol_Matrix(P1P0,:) = conj(1i.*Delta_zp.*sigma_P1P0...
    +1i.*(Omega_S/2).*(sqrt(2/3).*pol_plus_s.*sigma_S0P0...
    + sqrt(1/3).*pol_0_s.*(sigma_S1P0 - sigma_P1S0)...
    - sqrt(2/3).*pol_minus_s.*sigma_P1S1)...
    +1i.*(Omega_D/2).*(pol_plus_d.*(sqrt(1/3).*sigma_D1P0 - sigma_P1D0)...
    + sqrt(2/3).*pol_0_d.*(sigma_D2P0 - sigma_P1D1)...
    + pol_minus_d.*(sigma_D3P0 - sqrt(1/3).*sigma_P1D2))...
    -(gamma_S + gamma_D).*sigma_P1P0);

for h=2:numel(t)
    sigma_t_k1 = Evol_Matrix*sigma_t(:,h-1).*(t(h)-t(h-1));
    sigma_t_k2 = Evol_Matrix*(sigma_t(:,h-1)+sigma_t_k1./2).*(t(h)-t(h-1));
    sigma_t_k3 = Evol_Matrix*(sigma_t(:,h-1)+sigma_t_k2./2).*(t(h)-t(h-1));
    sigma_t_k4 = Evol_Matrix*(sigma_t(:,h-1)+sigma_t_k3).*(t(h)-t(h-1));
    
    sigma_t(:,h) = sigma_t(:,h-1) + (1/6).*(sigma_t_k1+2.*sigma_t_k2+2.*sigma_t_k3+sigma_t_k4);
end