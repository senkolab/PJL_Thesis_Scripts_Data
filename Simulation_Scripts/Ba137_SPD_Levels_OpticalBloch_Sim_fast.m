gamma_S = 95.3; %Decay rate of P_1/2 state to S_1/2 in MHz
gamma_D = 31; %Decay rate of P_1/2 state to D_3/2 in MHz
Omega_S1 = 0.3*899.4180;
Omega_S2 = 0.3*899.4180;
Omega_D0 = 0.2*1.4169e+03;
Omega_D1 = 0.2*1.4169e+03;
Omega_D2 = 0.2*1.4169e+03;
Omega_D3 = 0.2*1.4169e+03;
%Delta_S1 = -2*pi*20;
%Delta_S2 = -2*pi*40;
%Delta_D0 = -2*pi*200;
%Delta_D1 = -2*pi*200;
%Delta_D2 = -2*pi*200;
%Delta_D3 = -2*pi*200;

deltat = 0.0001;
t_end = 1;

t=0:deltat:t_end;
sigma_S1S1 = zeros(1,64); S1S1=1;
sigma_S2S2 = zeros(1,64); S2S2=2;
sigma_D0D0 = zeros(1,64); D0D0=3;
sigma_D1D1 = zeros(1,64); D1D1=4;
sigma_D2D2 = zeros(1,64); D2D2=5;
sigma_D3D3 = zeros(1,64); D3D3=6;
sigma_P1P1 = zeros(1,64); P1P1=7;
sigma_P2P2 = zeros(1,64); P2P2=8;
sigma_S1S2 = zeros(1,64); S1S2=9;
sigma_S1D0 = zeros(1,64); S1D0=10;
sigma_S1D1 = zeros(1,64); S1D1=11;
sigma_S1D2 = zeros(1,64); S1D2=12;
sigma_S1D3 = zeros(1,64); S1D3=13;
sigma_S1P1 = zeros(1,64); S1P1=14;
sigma_S1P2 = zeros(1,64); S1P2=15;
sigma_S2D0 = zeros(1,64); S2D0=16;
sigma_S2D1 = zeros(1,64); S2D1=17;
sigma_S2D2 = zeros(1,64); S2D2=18;
sigma_S2D3 = zeros(1,64); S2D3=19;
sigma_S2P1 = zeros(1,64); S2P1=20;
sigma_S2P2 = zeros(1,64); S2P2=21;
sigma_D0D1 = zeros(1,64); D0D1=22;
sigma_D0D2 = zeros(1,64); D0D2=23;
sigma_D0D3 = zeros(1,64); D0D3=24;
sigma_D0P1 = zeros(1,64); D0P1=25;
sigma_D0P2 = zeros(1,64); D0P2=26;
sigma_D1D2 = zeros(1,64); D1D2=27;
sigma_D1D3 = zeros(1,64); D1D3=28;
sigma_D1P1 = zeros(1,64); D1P1=29;
sigma_D1P2 = zeros(1,64); D1P2=30;
sigma_D2D3 = zeros(1,64); D2D3=31;
sigma_D2P1 = zeros(1,64); D2P1=32;
sigma_D2P2 = zeros(1,64); D2P2=33;
sigma_D3P1 = zeros(1,64); D3P1=34;
sigma_D3P2 = zeros(1,64); D3P2=35;
sigma_P1P2 = zeros(1,64); P1P2=36;
sigma_S2S1 = zeros(1,64); S2S1=37;
sigma_D0S1 = zeros(1,64); D0S1=38;
sigma_D1S1 = zeros(1,64); D1S1=39;
sigma_D2S1 = zeros(1,64); D2S1=40;
sigma_D3S1 = zeros(1,64); D3S1=41;
sigma_P1S1 = zeros(1,64); P1S1=42;
sigma_P2S1 = zeros(1,64); P2S1=43;
sigma_D0S2 = zeros(1,64); D0S2=44;
sigma_D1S2 = zeros(1,64); D1S2=45;
sigma_D2S2 = zeros(1,64); D2S2=46;
sigma_D3S2 = zeros(1,64); D3S2=47;
sigma_P1S2 = zeros(1,64); P1S2=48;
sigma_P2S2 = zeros(1,64); P2S2=49;
sigma_D1D0 = zeros(1,64); D1D0=50;
sigma_D2D0 = zeros(1,64); D2D0=51;
sigma_D3D0 = zeros(1,64); D3D0=52;
sigma_P1D0 = zeros(1,64); P1D0=53;
sigma_P2D0 = zeros(1,64); P2D0=54;
sigma_D2D1 = zeros(1,64); D2D1=55;
sigma_D3D1 = zeros(1,64); D3D1=56;
sigma_P1D1 = zeros(1,64); P1D1=57;
sigma_P2D1 = zeros(1,64); P2D1=58;
sigma_D3D2 = zeros(1,64); D3D2=59;
sigma_P1D2 = zeros(1,64); P1D2=60;
sigma_P2D2 = zeros(1,64); P2D2=61;
sigma_P1D3 = zeros(1,64); P1D3=62;
sigma_P2D3 = zeros(1,64); P2D3=63;
sigma_P2P1 = zeros(1,64); P2P1=64;

sigma_S1S1(S1S1) = 1;
sigma_S2S2(S2S2) = 1;
sigma_D0D0(D0D0) = 1;
sigma_D1D1(D1D1) = 1;
sigma_D2D2(D2D2) = 1;
sigma_D3D3(D3D3) = 1;
sigma_P1P1(P1P1) = 1;
sigma_P2P2(P2P2) = 1;
sigma_S1S2(S1S2) = 1;
sigma_S1D0(S1D0) = 1;
sigma_S1D1(S1D1) = 1;
sigma_S1D2(S1D2) = 1;
sigma_S1D3(S1D3) = 1;
sigma_S1P1(S1P1) = 1;
sigma_S1P2(S1P2) = 1;
sigma_S2D0(S2D0) = 1;
sigma_S2D1(S2D1) = 1;
sigma_S2D2(S2D2) = 1;
sigma_S2D3(S2D3) = 1;
sigma_S2P1(S2P1) = 1;
sigma_S2P2(S2P2) = 1;
sigma_D0D1(D0D1) = 1;
sigma_D0D2(D0D2) = 1;
sigma_D0D3(D0D3) = 1;
sigma_D0P1(D0P1) = 1;
sigma_D0P2(D0P2) = 1;
sigma_D1D2(D1D2) = 1;
sigma_D1D3(D1D3) = 1;
sigma_D1P1(D1P1) = 1;
sigma_D1P2(D1P2) = 1;
sigma_D2D3(D2D3) = 1;
sigma_D2P1(D2P1) = 1;
sigma_D2P2(D2P2) = 1;
sigma_D3P1(D3P1) = 1;
sigma_D3P2(D3P2) = 1;
sigma_P1P2(P1P2) = 1;
sigma_S2S1(S2S1) = 1;
sigma_D0S1(D0S1) = 1;
sigma_D1S1(D1S1) = 1;
sigma_D2S1(D2S1) = 1;
sigma_D3S1(D3S1) = 1;
sigma_P1S1(P1S1) = 1;
sigma_P2S1(P2S1) = 1;
sigma_D0S2(D0S2) = 1;
sigma_D1S2(D1S2) = 1;
sigma_D2S2(D2S2) = 1;
sigma_D3S2(D3S2) = 1;
sigma_P1S2(P1S2) = 1;
sigma_P2S2(P2S2) = 1;
sigma_D1D0(D1D0) = 1;
sigma_D2D0(D2D0) = 1;
sigma_D3D0(D3D0) = 1;
sigma_P1D0(P1D0) = 1;
sigma_P2D0(P2D0) = 1;
sigma_D2D1(D2D1) = 1;
sigma_D3D1(D3D1) = 1;
sigma_P1D1(P1D1) = 1;
sigma_P2D1(P2D1) = 1;
sigma_D3D2(D3D2) = 1;
sigma_P1D2(P1D2) = 1;
sigma_P2D2(P2D2) = 1;
sigma_P1D3(P1D3) = 1;
sigma_P2D3(P2D3) = 1;
sigma_P2P1(P2P1) = 1;

sigma_t = nan(numel(sigma_S1S1),numel(t));
sigma_t(:,1) = 0;
sigma_t(2,1) = 1;

Evol_Matrix = nan(numel(sigma_S1S1),numel(sigma_S1S1));

Evol_Matrix(S1S1,:) = (1i.*(Omega_S1/2).*(sigma_S1P1-sigma_P1S1)...
    +(3/8)*gamma_S.*sigma_P1P1 + (3/8)*gamma_S.*sigma_P2P2);
Evol_Matrix(S2S2,:) = (1i.*(Omega_S2/2).*(sigma_S2P1-sigma_P1S2)...
    +(5/8)*gamma_S.*sigma_P1P1 + (5/8)*gamma_S.*sigma_P2P2);
Evol_Matrix(D0D0,:) = (1i.*(Omega_D0/2).*(sigma_D0P1-sigma_P1D0)...
    +(1/9)*gamma_D.*sigma_P1P1);
Evol_Matrix(D1D1,:) = (1i.*(Omega_D1/2).*(sigma_D1P1-sigma_P1D1)...
    +(1/3)*gamma_D.*sigma_P1P1 + (1/5)*gamma_D.*sigma_P2P2);
Evol_Matrix(D2D2,:) = (1i.*(Omega_D2/2).*(sigma_D2P2-sigma_P2D2)...
    +(5/9)*gamma_D.*sigma_P1P1 + (1/3)*gamma_D.*sigma_P2P2);
Evol_Matrix(D3D3,:) = (1i.*(Omega_D3/2).*(sigma_D3P2-sigma_P2D3)...
    +(7/15)*gamma_D.*sigma_P2P2);
Evol_Matrix(P1P1,:) = (1i.*(Omega_S1/2).*(sigma_P1S1-sigma_S1P1)...
    +1i.*(Omega_S2/2).*(sigma_P1S2-sigma_S2P1)...
    +1i.*(Omega_D0/2).*(sigma_P1D0-sigma_D0P1)...
    +1i.*(Omega_D1/2).*(sigma_P1D1-sigma_D1P1)...
    -(gamma_S + gamma_D).*sigma_P1P1);
Evol_Matrix(P2P2,:) = (1i.*(Omega_D2/2).*(sigma_P2D2-sigma_D2P2)...
    +1i.*(Omega_D3/2).*(sigma_P2D3-sigma_D3P2)...
    -(gamma_S + gamma_D).*sigma_P2P2);
Evol_Matrix(S1S2,:) = (-1i.*(Delta_S1-Delta_S2).*sigma_S1S2...
    +1i.*(Omega_S2/2).*sigma_S1P1...
    -1i.*(Omega_S1/2).*sigma_P1S2);
Evol_Matrix(S1D0,:) = (-1i.*(Delta_S1-Delta_D0).*sigma_S1D0...
    +1i.*(Omega_D0/2).*sigma_S1P1...
    -1i.*(Omega_S1/2).*sigma_P1D0);
Evol_Matrix(S1D1,:) = (-1i.*(Delta_S1-Delta_D1).*sigma_S1D1...
    +1i.*(Omega_D1/2).*sigma_S1P1...
    -1i.*(Omega_S1/2).*sigma_P1D1);
Evol_Matrix(S1D2,:) = (1i.*Delta_D2.*sigma_S1D2...
    +1i.*(Omega_D2/2).*sigma_S1P2...
    -1i.*(Omega_S1/2).*sigma_P1D2);
Evol_Matrix(S1D3,:) = (1i.*Delta_D3.*sigma_S1D3...
    +1i.*(Omega_D3/2).*sigma_S1P2...
    -1i.*(Omega_S1/2).*sigma_P1D3);
Evol_Matrix(S1P1,:) = (-1i.*Delta_S1.*sigma_S1P1...
    +1i.*(Omega_S1/2).*(sigma_S1S1-sigma_P1P1)...
    +1i.*(Omega_S2/2).*sigma_S1S2...
    +1i.*(Omega_D0/2).*sigma_S1D0...
    +1i.*(Omega_D1/2).*sigma_S1D1...
    -((gamma_S+gamma_D)./2).*sigma_S1P1);
Evol_Matrix(S1P2,:) = (1i.*(Omega_D2/2).*sigma_S1D2...
    +1i.*(Omega_D3/2).*sigma_S1D3...
    -1i.*(Omega_S1/2).*sigma_P1P2...
    -((gamma_S+gamma_D)./2).*sigma_S1P2);
Evol_Matrix(S2D0,:) = (1i.*(Delta_D0-Delta_S2).*sigma_S2D0...
    +1i.*(Omega_D0/2).*sigma_S2P1...
    -1i.*(Omega_S2/2).*sigma_P1D0);
Evol_Matrix(S2D1,:) = (1i.*(Delta_D1-Delta_S2).*sigma_S2D1...
    +1i.*(Omega_D1/2).*sigma_S2P1...
    -1i.*(Omega_S2/2).*sigma_P1D1);
Evol_Matrix(S2D2,:) = (1i.*(Delta_D2 + Delta_S1 - Delta_S2).*sigma_S2D2...
    +1i.*(Omega_D2/2).*sigma_S2P2...
    -1i.*(Omega_S2/2).*sigma_P1D2);
Evol_Matrix(S2D3,:) = (1i.*(Delta_D3 + Delta_S1 - Delta_S2).*sigma_S2D3...
    +1i.*(Omega_D3/2).*sigma_S2P2...
    -1i.*(Omega_S2/2).*sigma_P1D3);
Evol_Matrix(S2P1,:) = (-1i.*Delta_S2.*sigma_S2P1...
    +1i.*(Omega_S1/2).*sigma_S2S1...
    +1i.*(Omega_S2/2).*(sigma_S2S2 - sigma_P1P1)...
    +1i.*(Omega_D0/2).*sigma_S2D0...
    +1i.*(Omega_D1/2).*sigma_S2D1...
    -((gamma_S+gamma_D)./2).*sigma_S2P1);
Evol_Matrix(S2P2,:) = (1i.*(Omega_D2/2).*sigma_S2D2...
    +1i.*(Omega_D3/2).*sigma_S2D3...
    +1i.*(Delta_S1 - Delta_S2).*sigma_S2P2...
    -1i.*(Omega_S2/2).*sigma_P1P2...
    -((gamma_S+gamma_D)./2).*sigma_S2P2);
Evol_Matrix(D0D1,:) = (1i.*(Delta_D1 - Delta_D0).*sigma_D0D1...
    +1i.*(Omega_D1/2).*sigma_D0P1...
    -1i.*(Omega_D0/2).*sigma_P1D1);
Evol_Matrix(D0D2,:) = (1i.*(Delta_D2 + Delta_S1 - Delta_D0).*sigma_D0D2...
    +1i.*(Omega_D2/2).*sigma_D0P2...
    -1i.*(Omega_D0/2).*sigma_P1D2);
Evol_Matrix(D0D3,:) = (1i.*(Delta_D3 + Delta_S1 - Delta_D0).*sigma_D0D3...
    +1i.*(Omega_D3/2).*sigma_D0P2...
    -1i.*(Omega_D0/2).*sigma_P1D3);
Evol_Matrix(D0P1,:) = (-1i.*Delta_D0.*sigma_D0P1...
    +1i.*(Omega_S1/2).*sigma_D0S1...
    +1i.*(Omega_S2/2).*sigma_D0S2...
    +1i.*(Omega_D0/2).*(sigma_D0D0 - sigma_P1P1)...
    +1i.*(Omega_D1/2).*sigma_D0D1...
    -((gamma_S+gamma_D)./2).*sigma_D0P1);
Evol_Matrix(D0P2,:) = (1i.*(Omega_D2/2).*sigma_D0D2...
    +1i.*(Omega_D3/2).*sigma_D0D3...
    +1i.*(Delta_S1-Delta_D0).*sigma_D0P2...
    -1i.*(Omega_D0/2).*sigma_P1P2...
    -((gamma_S+gamma_D)./2).*sigma_D0P2);
Evol_Matrix(D1D2,:) = (1i.*(Delta_D2 + Delta_S1 - Delta_D1).*sigma_D1D2...
    +1i.*(Omega_D2/2).*sigma_D1P2...
    -1i.*(Omega_D1/2).*sigma_P1D2);
Evol_Matrix(D1D3,:) = (1i.*(Delta_D3 + Delta_S1 - Delta_D1).*sigma_D1D3...
    +1i.*(Omega_D3/2).*sigma_D1P2...
    -1i.*(Omega_D1/2).*sigma_P1D3);
Evol_Matrix(D1P1,:) = (-1i.*Delta_D1.*sigma_D1P1...
    +1i.*(Omega_S1/2).*sigma_D1S1...
    +1i.*(Omega_S2/2).*sigma_D1S2...
    +1i.*(Omega_D0/2).*sigma_D1D0...
    +1i.*(Omega_D1/2).*(sigma_D1D1 - sigma_P1P1)...
    -((gamma_S+gamma_D)./2).*sigma_D1P1);
Evol_Matrix(D1P2,:) = (1i.*(Omega_D2/2).*sigma_D1D2...
    +1i.*(Omega_D3/2).*sigma_D1D3...
    +1i.*(Delta_S1-Delta_D1).*sigma_D1P2...
    -1i.*(Omega_D1/2).*sigma_P1P2...
    -((gamma_S+gamma_D)./2).*sigma_D1P2);
Evol_Matrix(D2D3,:) = (1i.*(Delta_D3 - Delta_D2).*sigma_D2D3...
    +1i.*(Omega_D3/2).*sigma_D2P2...
    -1i.*(Omega_D2/2).*sigma_P2D3);
Evol_Matrix(D2P1,:) = (-1i.*(Delta_S1 + Delta_D2).*sigma_D2P1...
    +1i.*(Omega_S1/2).*sigma_D2S1...
    +1i.*(Omega_S2/2).*sigma_D2S2...
    +1i.*(Omega_D0/2).*sigma_D2D0...
    +1i.*(Omega_D1/2).*sigma_D2D1...
    +1i.*(Omega_D2/2).*sigma_P2P1...
    -((gamma_S+gamma_D)./2).*sigma_D2P1);
Evol_Matrix(D2P2,:) = (1i.*(Omega_D2/2).*(sigma_D2D2 - sigma_P2P2)...
    +1i.*(Omega_D3/2).*sigma_D2D3...
    -1i.*Delta_D2.*sigma_D2P2...
    -((gamma_S+gamma_D)./2).*sigma_D2P2);
Evol_Matrix(D3P1,:) = (-1i.*(Delta_S1 + Delta_D3).*sigma_D3P1...
    +1i.*(Omega_S1/2).*sigma_D3S1...
    +1i.*(Omega_S2/2).*sigma_D3S2...
    +1i.*(Omega_D0/2).*sigma_D3D0...
    +1i.*(Omega_D1/2).*sigma_D3D1...
    +1i.*(Omega_D3/2).*sigma_P2P1...
    -((gamma_S+gamma_D)./2).*sigma_D3P1);
Evol_Matrix(D3P2,:) = (1i.*(Omega_D2/2).*sigma_D3D2...
    +1i.*(Omega_D3/2).*(sigma_D3D3 - sigma_P2P2)...
    -1i.*Delta_D3.*sigma_D3P2...
    -((gamma_S+gamma_D)./2).*sigma_D3P2);
Evol_Matrix(P1P2,:) = (1i.*(Omega_D2/2).*sigma_P1D2...
    +1i.*(Omega_D3/2).*sigma_P1D3...
    +1i.*Delta_S1.*sigma_P1P2...
    -1i.*(Omega_S1/2).*sigma_S1P2...
    -1i.*(Omega_S2/2).*sigma_S2P2...
    -1i.*(Omega_D0/2).*sigma_D0P2...
    -1i.*(Omega_D1/2).*sigma_D1P2...
    -(gamma_S + gamma_D).*sigma_P1P2);
Evol_Matrix(S2S1,:) = conj(-1i.*(Delta_S1-Delta_S2).*sigma_S2S1...
    +1i.*(Omega_S2/2).*sigma_P1S1...
    -1i.*(Omega_S1/2).*sigma_S2P1);
Evol_Matrix(D0S1,:) = conj(-1i.*(Delta_S1-Delta_D0).*sigma_D0S1...
    +1i.*(Omega_D0/2).*sigma_P1S1...
    -1i.*(Omega_S1/2).*sigma_D0P1);
Evol_Matrix(D1S1,:) = conj(-1i.*(Delta_S1-Delta_D1).*sigma_D1S1...
    +1i.*(Omega_D1/2).*sigma_P1S1...
    -1i.*(Omega_S1/2).*sigma_D1P1);
Evol_Matrix(D2S1,:) = conj(1i.*Delta_D2.*sigma_D2S1...
    +1i.*(Omega_D2/2).*sigma_P2S1...
    -1i.*(Omega_S1/2).*sigma_D2P1);
Evol_Matrix(D3S1,:) = conj(1i.*Delta_D3.*sigma_D3S1...
    +1i.*(Omega_D3/2).*sigma_P2S1...
    -1i.*(Omega_S1/2).*sigma_D3P1);
Evol_Matrix(P1S1,:) = conj(-1i.*Delta_S1.*sigma_P1S1...
    +1i.*(Omega_S1/2).*(sigma_S1S1-sigma_P1P1)...
    +1i.*(Omega_S2/2).*sigma_S2S1...
    +1i.*(Omega_D0/2).*sigma_D0S1...
    +1i.*(Omega_D1/2).*sigma_D1S1...
    -((gamma_S+gamma_D)./2).*sigma_P1S1);
Evol_Matrix(P2S1,:) = conj(1i.*(Omega_D2/2).*sigma_D2S1...
    +1i.*(Omega_D3/2).*sigma_D3S1...
    -1i.*(Omega_S1/2).*sigma_P2P1...
    -((gamma_S+gamma_D)./2).*sigma_P2S1);
Evol_Matrix(D0S2,:) = conj(1i.*(Delta_D0-Delta_S2).*sigma_D0S2...
    +1i.*(Omega_D0/2).*sigma_P1S2...
    -1i.*(Omega_S2/2).*sigma_D0P1);
Evol_Matrix(D1S2,:) = conj(1i.*(Delta_D1-Delta_S2).*sigma_D1S2...
    +1i.*(Omega_D1/2).*sigma_P1S2...
    -1i.*(Omega_S2/2).*sigma_D1P1);
Evol_Matrix(D2S2,:) = conj(1i.*(Delta_D2 + Delta_S1 - Delta_S2).*sigma_D2S2...
    +1i.*(Omega_D2/2).*sigma_P2S2...
    -1i.*(Omega_S2/2).*sigma_D2P1);
Evol_Matrix(D3S2,:) = conj(1i.*(Delta_D3 + Delta_S1 - Delta_S2).*sigma_D3S2...
    +1i.*(Omega_D3/2).*sigma_P2S2...
    -1i.*(Omega_S2/2).*sigma_D3P1);
Evol_Matrix(P1S2,:) = conj(-1i.*Delta_S2.*sigma_P1S2...
    +1i.*(Omega_S1/2).*sigma_S1S2...
    +1i.*(Omega_S2/2).*(sigma_S2S2 - sigma_P1P1)...
    +1i.*(Omega_D0/2).*sigma_D0S2...
    +1i.*(Omega_D1/2).*sigma_D1S2...
    -((gamma_S+gamma_D)./2).*sigma_P1S2);
Evol_Matrix(P2S2,:) = conj(1i.*(Omega_D2/2).*sigma_D2S2...
    +1i.*(Omega_D3/2).*sigma_D3S2...
    +1i.*(Delta_S1 - Delta_S2).*sigma_P2S2...
    -1i.*(Omega_S2/2).*sigma_P2P1...
    -((gamma_S+gamma_D)./2).*sigma_P2S2);
Evol_Matrix(D1D0,:) = conj(1i.*(Delta_D1 - Delta_D0).*sigma_D1D0...
    +1i.*(Omega_D1/2).*sigma_P1D0...
    -1i.*(Omega_D0/2).*sigma_D1P1);
Evol_Matrix(D2D0,:) = conj(1i.*(Delta_D2 + Delta_S1 - Delta_D0).*sigma_D2D0...
    +1i.*(Omega_D2/2).*sigma_P2D0...
    -1i.*(Omega_D0/2).*sigma_D2P1);
Evol_Matrix(D3D0,:) = conj(1i.*(Delta_D3 + Delta_S1 - Delta_D0).*sigma_D3D0...
    +1i.*(Omega_D3/2).*sigma_P2D0...
    -1i.*(Omega_D0/2).*sigma_D3P1);
Evol_Matrix(P1D0,:) = conj(-1i.*Delta_D0.*sigma_P1D0...
    +1i.*(Omega_S1/2).*sigma_S1D0...
    +1i.*(Omega_S2/2).*sigma_S2D0...
    +1i.*(Omega_D0/2).*(sigma_D0D0 - sigma_P1P1)...
    +1i.*(Omega_D1/2).*sigma_D1D0...
    -((gamma_S+gamma_D)./2).*sigma_P1D0);
Evol_Matrix(P2D0,:) = conj(1i.*(Omega_D2/2).*sigma_D2D0...
    +1i.*(Omega_D3/2).*sigma_D3D0...
    +1i.*(Delta_S1-Delta_D0).*sigma_P2D0...
    -1i.*(Omega_D0/2).*sigma_P2P1...
    -((gamma_S+gamma_D)./2).*sigma_P2D0);
Evol_Matrix(D2D1,:) = conj(1i.*(Delta_D2 + Delta_S1 - Delta_D1).*sigma_D2D1...
    +1i.*(Omega_D2/2).*sigma_P2D1...
    -1i.*(Omega_D1/2).*sigma_D2P1);
Evol_Matrix(D3D1,:) = conj(1i.*(Delta_D3 + Delta_S1 - Delta_D1).*sigma_D3D1...
    +1i.*(Omega_D3/2).*sigma_P2D1...
    -1i.*(Omega_D1/2).*sigma_D3P1);
Evol_Matrix(P1D1,:) = conj(-1i.*Delta_D1.*sigma_P1D1...
    +1i.*(Omega_S1/2).*sigma_S1D1...
    +1i.*(Omega_S2/2).*sigma_S2D1...
    +1i.*(Omega_D0/2).*sigma_D0D1...
    +1i.*(Omega_D1/2).*(sigma_D1D1 - sigma_P1P1)...
    -((gamma_S+gamma_D)./2).*sigma_P1D1);
Evol_Matrix(P2D1,:) = conj(1i.*(Omega_D2/2).*sigma_D2D1...
    +1i.*(Omega_D3/2).*sigma_D3D1...
    +1i.*(Delta_S1-Delta_D1).*sigma_P2D1...
    -1i.*(Omega_D1/2).*sigma_P2P1...
    -((gamma_S+gamma_D)./2).*sigma_P2D1);
Evol_Matrix(D3D2,:) = conj(1i.*(Delta_D3 - Delta_D2).*sigma_D3D2...
    +1i.*(Omega_D3/2).*sigma_P2D2...
    -1i.*(Omega_D2/2).*sigma_D3P2);
Evol_Matrix(P1D2,:) = conj(-1i.*(Delta_S1 + Delta_D2).*sigma_P1D2...
    +1i.*(Omega_S1/2).*sigma_S1D2...
    +1i.*(Omega_S2/2).*sigma_S2D2...
    +1i.*(Omega_D0/2).*sigma_D0D2...
    +1i.*(Omega_D1/2).*sigma_D1D2...
    +1i.*(Omega_D2/2).*sigma_P1P2...
    -((gamma_S+gamma_D)./2).*sigma_P1D2);
Evol_Matrix(P2D2,:) = conj(1i.*(Omega_D2/2).*(sigma_D2D2 - sigma_P2P2)...
    +1i.*(Omega_D3/2).*sigma_D3D2...
    -1i.*Delta_D2.*sigma_P2D2...
    -((gamma_S+gamma_D)./2).*sigma_P2D2);
Evol_Matrix(P1D3,:) = conj(-1i.*(Delta_S1 + Delta_D3).*sigma_P1D3...
    +1i.*(Omega_S1/2).*sigma_S1D3...
    +1i.*(Omega_S2/2).*sigma_S2D3...
    +1i.*(Omega_D0/2).*sigma_D0D3...
    +1i.*(Omega_D1/2).*sigma_D1D3...
    +1i.*(Omega_D3/2).*sigma_P1P2...
    -((gamma_S+gamma_D)./2).*sigma_P1D3);
Evol_Matrix(P2D3,:) = conj(1i.*(Omega_D2/2).*sigma_D2D3...
    +1i.*(Omega_D3/2).*(sigma_D3D3 - sigma_P2P2)...
    -1i.*Delta_D3.*sigma_P2D3...
    -((gamma_S+gamma_D)./2).*sigma_P2D3);
Evol_Matrix(P2P1,:) = conj(1i.*(Omega_D2/2).*sigma_D2P1...
    +1i.*(Omega_D3/2).*sigma_D3P1...
    +1i.*Delta_S1.*sigma_P2P1...
    -1i.*(Omega_S1/2).*sigma_P2S1...
    -1i.*(Omega_S2/2).*sigma_P2S2...
    -1i.*(Omega_D0/2).*sigma_P2D0...
    -1i.*(Omega_D1/2).*sigma_P2D1...
    -(gamma_S + gamma_D).*sigma_P2P1);

for h=2:numel(t)
    sigma_t_k1 = Evol_Matrix*sigma_t(:,h-1).*(t(h)-t(h-1));
    sigma_t_k2 = Evol_Matrix*(sigma_t(:,h-1)+sigma_t_k1./2).*(t(h)-t(h-1));
    sigma_t_k3 = Evol_Matrix*(sigma_t(:,h-1)+sigma_t_k2./2).*(t(h)-t(h-1));
    sigma_t_k4 = Evol_Matrix*(sigma_t(:,h-1)+sigma_t_k3).*(t(h)-t(h-1));
    
    sigma_t(:,h) = sigma_t(:,h-1) + (1/6).*(sigma_t_k1+2.*sigma_t_k2+2.*sigma_t_k3+sigma_t_k4);
end